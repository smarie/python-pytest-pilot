
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.1">
    
    
      
        <title>pytest_pilot</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pytest-pilot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="." title="pytest_pilot" class="md-header-nav__button md-logo" aria-label="pytest_pilot">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            pytest_pilot
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Home
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/smarie/python-pytest-pilot/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="pytest_pilot" class="md-nav__button md-logo" aria-label="pytest_pilot">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    pytest_pilot
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/smarie/python-pytest-pilot/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Home
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="." title="Home" class="md-nav__link md-nav__link--active">
      Home
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    Installing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-basics" class="md-nav__link">
    1. Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-arguments" class="md-nav__link">
    2. Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-names" class="md-nav__link">
    3. Names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-modes" class="md-nav__link">
    4. Modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-examples" class="md-nav__link">
    5. Examples
  </a>
  
    <nav class="md-nav" aria-label="5. Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#silos" class="md-nav__link">
    Silos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extender" class="md-nav__link">
    Extender
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hard-filter" class="md-nav__link">
    Hard filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-filter" class="md-nav__link">
    Soft filter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-misc" class="md-nav__link">
    7. Misc
  </a>
  
    <nav class="md-nav" aria-label="7. Misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-markers-in-parametrized-tests" class="md-nav__link">
    Using the markers in parametrized tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-customization" class="md-nav__link">
    Further customization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-verbosity-levels" class="md-nav__link">
    Debug / Verbosity levels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#help" class="md-nav__link">
    Help
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    Main features / benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
    <nav class="md-nav" aria-label="See Also">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    Others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    Want to contribute ?
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="api_reference/" title="API reference" class="md-nav__link">
      API reference
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    Installing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-basics" class="md-nav__link">
    1. Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-arguments" class="md-nav__link">
    2. Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-names" class="md-nav__link">
    3. Names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-modes" class="md-nav__link">
    4. Modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-examples" class="md-nav__link">
    5. Examples
  </a>
  
    <nav class="md-nav" aria-label="5. Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#silos" class="md-nav__link">
    Silos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extender" class="md-nav__link">
    Extender
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hard-filter" class="md-nav__link">
    Hard filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-filter" class="md-nav__link">
    Soft filter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-misc" class="md-nav__link">
    7. Misc
  </a>
  
    <nav class="md-nav" aria-label="7. Misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-markers-in-parametrized-tests" class="md-nav__link">
    Using the markers in parametrized tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-customization" class="md-nav__link">
    Further customization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-verbosity-levels" class="md-nav__link">
    Debug / Verbosity levels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#help" class="md-nav__link">
    Help
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    Main features / benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
    <nav class="md-nav" aria-label="See Also">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    Others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    Want to contribute ?
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/smarie/python-pytest-pilot/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="pytest-pilot">pytest-pilot<a class="headerlink" href="#pytest-pilot" title="Permanent link">&para;</a></h1>
<p><em>Slice in your test base thanks to powerful markers</em></p>
<p><a href="https://pypi.python.org/pypi/pytest-pilot/"><img alt="Python versions" src="https://img.shields.io/pypi/pyversions/pytest-pilot.svg" /></a> <a href="https://travis-ci.org/smarie/python-pytest-pilot"><img alt="Build Status" src="https://travis-ci.org/smarie/python-pytest-pilot.svg?branch=master" /></a> <a href="https://smarie.github.io/python-pytest-pilot/junit/report.html"><img alt="Tests Status" src="https://smarie.github.io/python-pytest-pilot/junit/junit-badge.svg?dummy=8484744" /></a> <a href="https://codecov.io/gh/smarie/python-pytest-pilot"><img alt="codecov" src="https://codecov.io/gh/smarie/python-pytest-pilot/branch/master/graph/badge.svg" /></a></p>
<p><a href="https://smarie.github.io/python-pytest-pilot/"><img alt="Documentation" src="https://img.shields.io/badge/doc-latest-blue.svg" /></a> <a href="https://pypi.python.org/pypi/pytest-pilot/"><img alt="PyPI" src="https://img.shields.io/pypi/v/pytest-pilot.svg" /></a> <a href="https://pepy.tech/project/pytest-pilot"><img alt="Downloads" src="https://pepy.tech/badge/pytest-pilot" /></a> <a href="https://pepy.tech/project/pytest-pilot"><img alt="Downloads per week" src="https://pepy.tech/badge/pytest-pilot/week" /></a> <a href="https://github.com/smarie/python-pytest-pilot/stargazers"><img alt="GitHub stars" src="https://img.shields.io/github/stars/smarie/python-pytest-pilot.svg" /></a></p>
<p>In <code>pytest</code> we can create custom markers and filter tests according to them using the <code>-m</code> flag, as explained <a href="https://docs.pytest.org/en/latest/example/markers.html">here</a>. However </p>
<ul>
<li>
<p>by default it only supports one kind of marker query behaviour: a test with a mark <M> will run <em>even</em> if you do not use the <code>-m &lt;M&gt;</code> flag. If you wish to implement something more complex, you have to add code in your <code>contest.py</code> as explained <a href="http://doc.pytest.org/en/latest/example/markers.html#marking-platform-specific-tests-with-pytest">here</a> </p>
</li>
<li>
<p>It is also not easy to understand what happens when a marker has a parameter (an argument) and how to filter according to this. It seems from <a href="http://doc.pytest.org/en/latest/example/markers.html#custom-marker-and-command-line-option-to-control-test-runs">the examples in the doc</a> that the only way to handle these is again to add code in your <code>contest.py</code></p>
</li>
<li>
<p>In other words, it is not easy to expose a "functional" view to the user, even if all core mechanisms are perfectly working.</p>
</li>
</ul>
<p><code>pytest-pilot</code> proposes <strong>a high-level API to create and register pytest markers so that they are easy to understand and use</strong>. To do this it does not use fancy mechanisms: it simply automates most the patterns demonstrated in the <code>pytest</code> documentation. </p>
<h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code>&gt; pip install pytest-pilot
</code></pre></div>


<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<h3 id="1-basics">1. Basics<a class="headerlink" href="#1-basics" title="Permanent link">&para;</a></h3>
<p>The easiest way to define a marker is to create an instance of <code>EasyMarker</code> in <a href="https://docs.pytest.org/en/latest/writing_plugins.html#conftest-py-plugins">a <code>contest.py</code> file</a>. </p>
<p>When you create a marker with <code>mymarker = EasyMarker('mymarker', ...)</code>, you get 2 things:</p>
<ul>
<li><code>@mymarker(arg)</code> is a decorator that is equivalent to <code>@pytest.mark.mymarker(arg)</code>. You can use it to mark some of your tests. For example:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nd">@mymarker</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@mymarker</span><span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_bar</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div>


<ul>
<li>an associated <code>--mymarker</code> CLI option is automatically registered: <code>pytest --mymarker=&lt;arg&gt;</code> or <code>pytest --mymarker &lt;arg&gt;</code> will enable this option. For example</li>
</ul>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest --mymarker<span class="o">=</span>red
</code></pre></div>


<h3 id="2-arguments">2. Arguments<a class="headerlink" href="#2-arguments" title="Permanent link">&para;</a></h3>
<p>By default the <code>@mymarker</code> decorator accepts a single argument. The set of allowed arguments can be restricted with <code>allowed_values=...</code>. Alternately <code>EasyMarker</code> can be declared to have no argument and be just a flag (<code>has_arg=False</code>). In that case the decorator can be used without parenthesis, and the CLI option will be a flag as well.</p>
<h3 id="3-names">3. Names<a class="headerlink" href="#3-names" title="Permanent link">&para;</a></h3>
<p>By default the option has just a long name, identical to the marker id. You can customize it and optionally add a short name using <code>cmdoption_long</code> and <code>cmdoption_short</code>.</p>
<h3 id="4-modes">4. Modes<a class="headerlink" href="#4-modes" title="Permanent link">&para;</a></h3>
<p>Now all the purpose of this library is to allow you to easily configure <strong>which tests should run</strong> when this <code>--mymarker</code> CLI option is active, and which ones should run when it is not. This is configured with the mandatory <code>mode</code> argument, with 4 possible values:</p>
<ul>
<li>
<p><code>'silos'</code>: when the option is <strong>inactive</strong>, only non-marked tests are run. When the option is <strong>active</strong> (<code>pytest --mymarker &lt;arg&gt;</code>), only tests marked with <code>@mymarker(&lt;arg&gt;)</code> run. There is no test in common between these "silos".</p>
</li>
<li>
<p><code>'extender'</code>: when the option is <strong>inactive</strong>, only non-marked tests are run, this is the "base" set of tests. When the option is <strong>active</strong> (<code>pytest --mymarker &lt;arg&gt;</code>), it tests marked with <code>@mymarker(&lt;arg&gt;)</code> are added to the base set.</p>
</li>
<li>
<p><code>'hard_filter'</code>: when the option is inactive, all tests run. When the option is active, only the relevant marked tests run.</p>
</li>
<li>
<p><code>'soft_filter'</code>: when the option is inactive, all tests run. When the option is active, all non-marked tests continue to run, but among marked tests, only the relevant ones run. </p>
</li>
</ul>
<h3 id="5-examples">5. Examples<a class="headerlink" href="#5-examples" title="Permanent link">&para;</a></h3>
<h4 id="silos">Silos<a class="headerlink" href="#silos" title="Permanent link">&para;</a></h4>
<p>The silo mode is a way to partition your tests into several, non-intersecting, sets. Unmarked tests are in the "default" silo.</p>
<p>For example we can create an <code>envid</code> marker defining the python environment on which a test runs. Tests that have this marker should run <strong>only</strong> if <code>pytest</code> is called with a <code>--envid</code> flag indicating that the environment is active. Tests that do not have this marker are considered in the "default" environment and should only run when no environment is set.</p>
<ul>
<li><code>conftest.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_pilot</span> <span class="kn">import</span> <span class="n">EasyMarker</span>

<span class="n">envid</span> <span class="o">=</span> <span class="n">EasyMarker</span><span class="p">(</span><span class="s1">&#39;envid&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;silos&#39;</span><span class="p">)</span>
</code></pre></div>


<ul>
<li><code>test_silos.py</code> (you'll have to create an <code>__init__.py</code> in the folder to allow for relative imports):</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">.conftest</span> <span class="kn">import</span> <span class="n">envid</span>

<span class="nd">@envid</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo_a</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@envid</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo_b</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div>


<p>Running <code>pytest</code> (with the <code>-rs</code> option to show a summary of skipped tests) yields:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs
============================= test session starts ==========================================
(...)
collected 3 items

pytest_pilot/test_doc/test_silos.py::test_foo_a SKIPPED       [ 33%]
pytest_pilot/test_doc/test_silos.py::test_foo_b SKIPPED       [ 66%]
pytest_pilot/test_doc/test_silos.py::test_foo PASSED          [100%]

========================== short test summary info =========================================
SKIPPED [1] &lt;file&gt;: This test requires &#39;envid&#39;=&#39;a&#39;. Run `pytest --envid=a` to activate it.
SKIPPED [1] &lt;file&gt;: This test requires &#39;envid&#39;=&#39;b&#39;. Run `pytest --envid=b` to activate it.
========================== 1 passed, 2 skipped in 0.04s ====================================
</code></pre></div>


<p>And we can instead activate environment <code>'b'</code>.</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs --envid=b
============================= test session starts ==========================================
(...)
collected 3 items

pytest_pilot/test_doc/test_silos.py::test_foo_a SKIPPED        [ 33%]
pytest_pilot/test_doc/test_silos.py::test_foo_b PASSED         [ 66%]
pytest_pilot/test_doc/test_silos.py::test_foo SKIPPED          [100%]

========================== short test summary info =============================================================
SKIPPED [1] &lt;file&gt;: This test requires &#39;envid&#39;=&#39;a&#39;. Currently `--envid=b` so it is skipped.
SKIPPED [1] &lt;file&gt;: This test does not have mark &#39;envid&#39;, and pytest was run with `--envid=b` so it is skipped
========================== 1 passed, 2 skipped in 0.04s ========================================================
</code></pre></div>


<p>Note that as can be seen above, <code>test_foo</code>, that was not marked, is now skipped (it is implicitly in the "no env" silo so if we activate another silo it becomes skipped). This is the main difference with the <a href="#extender">"extender" mode below</a>.</p>
<h4 id="extender">Extender<a class="headerlink" href="#extender" title="Permanent link">&para;</a></h4>
<p>The extender mode is probably the simplest to understand: marked tests are optional tests, that can be added to the other tests when the option is specified. For example let's mark a few tests as being slow tests that should be skipped for daily testing. Note that this time we'll create a marker with no arguments to show that such markers can also be created, but it could of course receive arguments just as in previous example.</p>
<ul>
<li><code>conftest.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_pilot</span> <span class="kn">import</span> <span class="n">EasyMarker</span>

<span class="n">slow</span> <span class="o">=</span> <span class="n">EasyMarker</span><span class="p">(</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span> <span class="n">has_arg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;extender&#39;</span><span class="p">)</span>
</code></pre></div>


<ul>
<li><code>test_extender.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">.conftest</span> <span class="kn">import</span> <span class="n">slow</span>

<span class="nd">@slow</span>
<span class="k">def</span> <span class="nf">test_bar_slow</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">test_bar</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div>


<p>Running <code>pytest</code> (with the <code>-rs</code> option to show a summary of skipped tests) yields:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs
============================= test session starts ==========================================
(...)
collected 2 items

pytest_pilot/test_doc/test_extender.py::test_bar_slow SKIPPED       [ 50%]
pytest_pilot/test_doc/test_extender.py::test_foo PASSED             [100%]

========================== short test summary info =========================================
SKIPPED [1] &lt;file&gt;: This test requires &#39;slow&#39;. Run `pytest --slow` to activate it.
========================== 1 passed, 1 skipped in 0.04s ====================================
</code></pre></div>


<p>And we can run all tests including the slow ones with <code>--slow</code>:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs --slow
============================= test session starts ==========================================
(...)
collected 2 items

pytest_pilot/test_doc/test_extender.py::test_bar_slow PASSED        [ 50%]
pytest_pilot/test_doc/test_extender.py::test_foo PASSED             [100%]

================================ 2 passed in 0.04s =========================================
</code></pre></div>


<h4 id="hard-filter">Hard filter<a class="headerlink" href="#hard-filter" title="Permanent link">&para;</a></h4>
<p>"Hard filter" mode is the opposite of "Extender". Instead of adding tests when the option is active, it removes all irrelevant tests, keeping only those matching the query.</p>
<ul>
<li><code>conftest.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_pilot</span> <span class="kn">import</span> <span class="n">EasyMarker</span>

<span class="c1"># below we demonstrate the usage of `allowed_values` to restrict the possible values</span>
<span class="n">flavour</span> <span class="o">=</span> <span class="n">EasyMarker</span><span class="p">(</span><span class="s1">&#39;flavour&#39;</span><span class="p">,</span> <span class="n">allowed_values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;hard_filter&#39;</span><span class="p">)</span>
</code></pre></div>


<ul>
<li><code>test_hardfilter.py</code> (you'll have to create an <code>__init__.py</code> in the folder to allow for relative imports):</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">.conftest</span> <span class="kn">import</span> <span class="n">flavour</span>

<span class="nd">@flavour</span><span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo_yellow</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@flavour</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo_red</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div>


<p>Running <code>pytest</code> (with the <code>-rs</code> option to show a summary of skipped tests) yields:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs
============================= test session starts ==========================================
(...)
collected 3 items                                                                                                                                                                                                   
pytest_pilot/test_doc/test_hardfilter.py::test_foo_yellow PASSED         [ 33%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo_red PASSED            [ 66%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo PASSED                [100%]

================================ 3 passed in 0.04s =========================================
</code></pre></div>


<p>We can instead filter on tests with the <code>'red'</code> flavour:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs --flavour=red
============================= test session starts ==========================================
(...)
collected 3 items

pytest_pilot/test_doc/test_hardfilter.py::test_foo_yellow SKIPPED         [ 33%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo_red PASSED             [ 66%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo SKIPPED                [100%]

========================== short test summary info =============================================================
SKIPPED [1] &lt;file&gt;: This test requires &#39;flavour&#39;=&#39;yellow&#39;. Currently `--flavour=red` so it is skipped.
SKIPPED [1] &lt;file&gt;: This test does not have mark &#39;flavour&#39;, and pytest was run with `--flavour=red` so it is skipped.
========================== 1 passed, 2 skipped in 0.04s ========================================================
</code></pre></div>


<p>You can see that <code>test_foo</code>, that was not marked, has been skipped. This is the main difference with the <a href="#soft-filter">soft filer</a> presented below.</p>
<h4 id="soft-filter">Soft filter<a class="headerlink" href="#soft-filter" title="Permanent link">&para;</a></h4>
<p>"Soft filter" mode is very similar to "Hard filter". The only difference is for non-marked tests. While in hard filter mode they are skipped as soon as the option is active, in soft filter mode they are always run.</p>
<ul>
<li><code>conftest.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_pilot</span> <span class="kn">import</span> <span class="n">EasyMarker</span>

<span class="n">flavour</span> <span class="o">=</span> <span class="n">EasyMarker</span><span class="p">(</span><span class="s1">&#39;flavour&#39;</span><span class="p">,</span> <span class="n">allowed_values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;soft_filter&#39;</span><span class="p">)</span>
</code></pre></div>


<ul>
<li><code>test_hardfilter.py</code> (you'll have to create an <code>__init__.py</code> in the folder to allow for relative imports):</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">.conftest</span> <span class="kn">import</span> <span class="n">flavour</span>

<span class="nd">@flavour</span><span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo_yellow</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@flavour</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo_red</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div>


<p>Running <code>pytest</code> (with the <code>-rs</code> option to show a summary of skipped tests) yields:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs
============================= test session starts ==========================================
(...)
collected 3 items                                                                                                                                                                                                   
pytest_pilot/test_doc/test_hardfilter.py::test_foo_yellow PASSED         [ 33%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo_red PASSED            [ 66%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo PASSED                [100%]

================================ 3 passed in 0.04s =========================================
</code></pre></div>


<p>We can instead filter on tests with the <code>'yellow'</code> flavour:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -rs --flavour=yellow
============================= test session starts ==========================================
(...)
collected 3 items

pytest_pilot/test_doc/test_hardfilter.py::test_foo_yellow PASSED           [ 33%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo_red SKIPPED             [ 66%]
pytest_pilot/test_doc/test_hardfilter.py::test_foo PASSED                  [100%]

========================== short test summary info =============================================================
SKIPPED [1] &lt;file&gt;: This test requires &#39;flavour&#39;=&#39;red&#39;. Currently `--flavour=yellow` so it is skipped.
========================== 2 passed, 1 skipped in 0.04s ========================================================
</code></pre></div>


<p>You can see that now <code>test_foo</code>, that was not marked, was not skipped - as opposed to the previous example of "hard filter".</p>
<h3 id="7-misc">7. Misc<a class="headerlink" href="#7-misc" title="Permanent link">&para;</a></h3>
<h4 id="using-the-markers-in-parametrized-tests">Using the markers in parametrized tests<a class="headerlink" href="#using-the-markers-in-parametrized-tests" title="Permanent link">&para;</a></h4>
<p>If your tests are parametrized, you can use the markers on individual parametrization value:</p>
<ul>
<li>either using the traditional <code>pytest.param(&lt;argvalues&gt;, marks=&lt;marker&gt;)</code></li>
<li>either using the provided convenience method <code>&lt;marker&gt;.param(&lt;argvalues&gt;)</code></li>
</ul>
<p>As shown below: </p>
<div class="codehilite"><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">marks</span><span class="o">=</span><span class="n">slow</span><span class="p">),</span>
    <span class="mi">0</span><span class="p">,</span> 
    <span class="n">pytest</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">marks</span><span class="o">=</span><span class="n">envid</span><span class="p">(</span><span class="s2">&quot;win&quot;</span><span class="p">)),</span>
    <span class="n">slow</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> 
    <span class="mi">1</span><span class="p">,</span>
    <span class="n">envid</span><span class="p">(</span><span class="s2">&quot;win&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">])</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>


<h4 id="further-customization">Further customization<a class="headerlink" href="#further-customization" title="Permanent link">&para;</a></h4>
<p>See <a href="api_reference/">API reference</a> for details.</p>
<h4 id="debug-verbosity-levels">Debug / Verbosity levels<a class="headerlink" href="#debug-verbosity-levels" title="Permanent link">&para;</a></h4>
<p>You can use the verbose pytest flags with the <code>-s</code> option to get a little more explanation about why tests are skipped or why they are NOT skipped (while you think they should):</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest -s -vv --flavour<span class="o">=</span>red
<span class="o">(</span>verbose explanations<span class="o">)</span>
&gt;&gt;&gt; pytest -s -vvv --flavour<span class="o">=</span>red
<span class="o">(</span>even more verbose explanations<span class="o">)</span>
</code></pre></div>


<h4 id="help">Help<a class="headerlink" href="#help" title="Permanent link">&para;</a></h4>
<p>Help on command options is automatically added to the <code>pytest --help</code> output:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest --help

<span class="o">(</span>...<span class="o">)</span>

custom options:
  --flavour<span class="o">=</span>NAME        run tests marked as requiring flavour NAME <span class="o">(</span>marked with @flavour<span class="o">(</span>NAME<span class="o">))</span>, as well as tests not marked with @flavour. If you call <span class="sb">`</span>pytest<span class="sb">`</span> without this option, tests marked with @flavour will *all* be run.

<span class="o">(</span>...<span class="o">)</span>
</code></pre></div>


<p>Help on markers is automatically added to the <code>pytest --markers</code> output:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; pytest --markers

<span class="o">(</span>...<span class="o">)</span>

@pytest.mark.flavour<span class="o">(</span>value<span class="o">)</span>: mark <span class="nb">test</span> to run *both* when --flavour <span class="o">(</span><span class="s1">&#39;flavour&#39;</span> option<span class="o">)</span> is <span class="nb">set</span> to &lt;value&gt; and <span class="k">if</span> --flavour is not set. &lt;value&gt; should be one of <span class="o">(</span><span class="s1">&#39;red&#39;</span>, <span class="s1">&#39;yellow&#39;</span><span class="o">)</span>.

<span class="o">(</span>...<span class="o">)</span>
</code></pre></div>


<h2 id="main-features-benefits">Main features / benefits<a class="headerlink" href="#main-features-benefits" title="Permanent link">&para;</a></h2>
<ul>
<li>Create intuitive markers in minutes, with consistent behaviour and associated command options, documented with user-friendly help.</li>
</ul>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<ul>
<li>pytest tutorial on <a href="https://docs.pytest.org/en/latest/example/markers.html">working with custom markers</a></li>
<li><a href="https://stackoverflow.com/a/52845103/7262247">this excellent explanation</a> about how to add options so as to filter on custom markers or on parameter names and values</li>
<li>pytest <a href="https://docs.pytest.org/en/latest/_modules/_pytest/hookspec.html">hooks</a></li>
</ul>
<h3 id="others">Others<a class="headerlink" href="#others" title="Permanent link">&para;</a></h3>
<p><em>Do you like this library ? You might also like <a href="https://github.com/smarie/OVERVIEW#python">my other python libraries</a></em> </p>
<h2 id="want-to-contribute">Want to contribute ?<a class="headerlink" href="#want-to-contribute" title="Permanent link">&para;</a></h2>
<p>Details on the github page: <a href="https://github.com/smarie/python-pytest-pilot">https://github.com/smarie/python-pytest-pilot</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
        
          <a href="api_reference/" title="API reference" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                API reference
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="assets/javascripts/bundle.aa3f9871.min.js"></script><script id="__lang" type="application/json">{"search.result.one": "1 matching document", "search.config.lang": "en", "clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.result.more.one": "1 more on this page", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.config.separator": "[\\s\\-]+", "search.result.none": "No matching documents", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "search.config.pipeline": "trimmer, stopWordFilter"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>